<html>

<head>

	<meta name="author" content="liurh" />
	<meta name="date" content="2021/10/24" />
	<meta charset="UTF-8">

	<link rel="stylesheet" href="./reveal.css">
	<link rel="stylesheet" href="./white.css">

	<style>
		html,
		body,
		div {
			width: 100%;
			height: 100%;
			margin: 0;
			padding: 0;
		}

		img {
			width: 60%;
			height: 60%;
			margin: auto;
			padding: 0;
		}
	</style>

	<script>

		/*      变量初始化
						session->session数量(修改session需要添加slide!)
						session_trial->每个session的trial数量
						trials->总trials数量
		*/
		var session = 5;
		var session_trial = 3;
		var trials = session * session_trial;
		/*       
				  init记录初始N个session的随机值
						label记录标签
						temp记录(label-init)剩下的值
						result记录最终的输出序列
						0->左手; 1->右手; 2->空闲
		*/

		var init = new Array(session);
		var label = new Array(trials);
		var result = new Array(trials);
		var temp = new Array(trials - session);

		var banners = ["./gif/left.gif", "./gif/right.gif", "./gif/rest.gif"];
		var counter = 0;

		function run(s) {
			//      获得gif图片
			//			随机选择[0,1,2]
			num = Math.floor(Math.random() * 3)

			if (s == "banner1")
				document.getElementById("banner1").src = banners[num];
			if (s == "banner2")
				document.getElementById("banner2").src = banners[num];
			if (s == "banner3")
				document.getElementById("banner3").src = banners[num];
			if (s == "banner4")
				document.getElementById("banner4").src = banners[num];
			if (s == "banner5")
				document.getElementById("banner5").src = banners[num];

			//          console.log("num = "+(num)); 	
			//          console.log("counter = "+(counter)); 

			label[counter] = num;
			counter++;
		}

		function getLabel(label) {
			//			计算最终的输出序列result，由init和temp组成，init存储所有session第一个刺激，temp存储每个session之后的数据
			m = 0;
			for (k = 0; k < init.length; k++) {
				init[k] = label[k]
			}
			for (i = 0; i < temp.length; i++) {
				temp[i] = label[i + init.length]
			}
			for (j = 0; j < label.length; j++) {
				if (j % session_trial == 0) {
					result[j] = init[parseInt(j / session_trial)]
				}
				else {
					result[j] = temp[m]
					m++
				}
			}

		}
		// function s() {
		// 	document.getElementById("sdf").src = "./left.mp4"
		// }

	</script>

</head>

<div class="reveal">
	<div class="slides">


		<!--SESSION 1-->
		<section data-autoslide="4000" data-background-color="rgb(0,0,0)" data-transition="none">Please be prepared,
			the MI experiment will begin immediately......</section>

		<section data-autoslide="2000" data-background-color="rgb(0,0,0)" id="second">Session 1 will start
			immediately...</section>

		<section data-autoslide="1000" id="1" data-background-color="rgb(0,0,0)">
			<!--<video data-autoplay src="./left.mp4">	</video>-->
			<img id="banner1" alt="banner1" src="./" />
			<script>document.getElementById("banner1").onload = run('banner1');</script>
		</section>

		<!--黑屏4秒-->
		<section data-autoslide="2000" data-background-color="rgb(0,0,0)"></section>

		<!--rest-->
		<section data-autoslide="2000" data-background-color="rgb(0,0,0)">Please rest</section>


		<section data-background-color="rgb(0,0,0)" id="q1">
			Session 1 is over,<br />
			please take a break......<br />
			If you want to start the next session,<br />
			press Spacebar to continue......
		</section>


		<!--SESSION 2-->
		<section data-autoslide="2000" data-background-color="rgb(0,0,0)" data-transition="none" data-autoslide="10000">
			Please be prepared,
			the MI experiment will begin immediately......</section>

		<section data-autoslide="2000" data-background-color="rgb(0,0,0)" data-transition="none">Session 2 will start
			immediately...</section>

		<section data-autoslide="1000" id="2" data-background-color="rgb(0,0,0)">
			<img id="banner2" alt="banner2" src="./" />
			<script>document.getElementById("banner2").onload = run('banner2');</script>
		</section>

		<!--黑屏4秒-->
		<section data-autoslide="1000" data-background-color="rgb(0,0,0)"></section>

		<!--rest-->
		<section data-autoslide="1000" data-background-color="rgb(0,0,0)">Please rest</section>


		<section data-background-color="rgb(0,0,0)" id="q2">
			Session 2 is over,<br />
			please take a break......<br />
			If you want to start the next session,<br />
			press Spacebar to continue......
		</section>



		<!--SESSION 3-->
		<section data-autoslide="2000" data-background-color="rgb(0,0,0)" data-transition="none">Please be prepared,
			the MI experiment will begin immediately......</section>

		<section data-autoslide="2000" data-background-color="rgb(0,0,0)" data-transition="none">Session 3 will start
			immediately...</section>
		<section data-autoslide="1000" id="3" data-background-color="rgb(0,0,0)">
			<img id="banner3" alt="banner3" src="./" />
			<script>document.getElementById("banner3").onload = run('banner3');</script>
		</section>


		<!--黑屏4秒-->
		<section data-autoslide="1000" data-background-color="rgb(0,0,0)"></section>

		<!--rest-->
		<section data-autoslide="1000" data-background-color="rgb(0,0,0)">Please rest</section>


		<section data-background-color="rgb(0,0,0)" id="q3">
			Session 3 is over,<br />
			please take a break......<br />
			If you want to start the next session,<br />
			press Spacebar to continue......
		</section>



		<!--SESSION 4-->
		<section data-autoslide="2000" data-background-color="rgb(0,0,0)" data-transition="none">Please be prepared,
			the MI experiment will begin immediately......</section>
		<section data-autoslide="2000" data-background-color="rgb(0,0,0)" data-transition="none">Session 4 will start
			immediately...</section>

		<section data-autoslide="1000" id="4" data-background-color="rgb(0,0,0)">
			<img id="banner4" alt="banner4" src="./" />
			<script>document.getElementById("banner4").onload = run('banner4');</script>
		</section>

		<!--黑屏4秒-->
		<section data-autoslide="1000" data-background-color="rgb(0,0,0)"></section>

		<!--rest-->
		<section data-autoslide="1000" data-background-color="rgb(0,0,0)">Please rest</section>



		<section data-background-color="rgb(0,0,0)" id="q4">
			Session 4 is over,<br />
			please take a break......<br />
			If you want to start the next session,<br />
			press Spacebar to continue......
		</section>



		<!--SESSION 5-->
		<section data-autoslide="2000" data-background-color="rgb(0,0,0)" id="q4" data-transition="none">Please be
			prepared,
			the MI experiment will begin immediately......</section>
		<section data-autoslide="2000" data-background-color="rgb(0,0,0)" data-transition="none">Session 5 will start
			immediately...</section>

		<section data-autoslide="1000" id="5" data-background-color="rgb(0,0,0)">
			<img id="banner5" alt="banner5" src="./" />
			<script>document.getElementById("banner5").onload = run('banner5');</script>
		</section>

		<!--黑屏4秒-->
		<section data-autoslide="1000" data-background-color="rgb(0,0,0)"></section>

		<!--rest-->
		<section data-autoslide="1000" data-background-color="rgb(0,0,0)">Please rest</section>

		<!--实验结束-->
		<section data-autoslide="10000" id="q5" data-background-color="rgb(0,0,0)">End of the experiment, thank you for
			participating!</section>
	</div>
</div>
<script src="./reveal.js"></script>
<script>
	Reveal.initialize({
		//    	slider初始化
		width: "100%", height: "110%",
		margin: 0, minScale: 1,
		maxScale: 1.2, controls: false,
		progress: true, overview: false,
		viewDistance: 23, keyboard: false,
		transition: 'fade', transitionSpeed: 'fast'
	});


	Reveal.addEventListener('slidechanged', function (event) {
		//			在手动切换slide后会暂停自动播放，也可以按 a键来暂停或恢复自动播放。      	
		//    	每张slide切换时将发生以下操作,不添加或减少slide就不需要改下面的参数!
		//			Reveal.slide跳转到指定的slide
		Reveal.configure({ keyboard: false });

		if ((Reveal.getCurrentSlide().id == 'q1') && (counter - session < 1 * (session_trial - 1))) {
			Reveal.slide(2)
			run("banner1")
		}
		if ((Reveal.getCurrentSlide().id == 'q2') && (counter - session < 2 * (session_trial - 1))) {
			Reveal.slide(8)
			run("banner2")
		}
		if ((Reveal.getCurrentSlide().id == 'q3') && (counter - session < 3 * (session_trial - 1))) {
			Reveal.slide(14)
			run("banner3")
		}
		if ((Reveal.getCurrentSlide().id == 'q4') && (counter - session < 4 * (session_trial - 1))) {
			Reveal.slide(20)
			run("banner4")
		}
		if ((Reveal.getCurrentSlide().id == 'q5') && (counter - session < 5 * (session_trial - 1))) {
			Reveal.slide(26)
			run("banner5")
		}



		//			被试按下空格键开始下一个session
		if ((Reveal.getCurrentSlide().id == 'q1') && counter - session == 1 * (session_trial - 1)) {
			Reveal.configure({ keyboard: { 32: 'next' } })
		}
		if ((Reveal.getCurrentSlide().id == 'q2') && counter - session == 2 * (session_trial - 1)) {
			Reveal.configure({ keyboard: { 32: 'next' } })
		}
		if ((Reveal.getCurrentSlide().id == 'q3') && counter - session == 3 * (session_trial - 1)) {
			Reveal.configure({ keyboard: { 32: 'next' } })
		}
		if ((Reveal.getCurrentSlide().id == 'q4') && counter - session == 4 * (session_trial - 1)) {
			Reveal.configure({ keyboard: { 32: 'next' } })
		}
		if ((Reveal.getCurrentSlide().id == 'q5') && counter - session == 5 * (session_trial - 1)) {
			Reveal.configure({ keyboard: { 32: 'next' } })
		}


		if (counter == trials)
			getLabel(label)
	});
</script>
</body>

</html>